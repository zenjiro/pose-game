# pose-game é«˜é€ŸåŒ– å®Ÿè¡Œè¨ˆç”»ï¼ˆplan.mdï¼‰

ç›®çš„
- ç¾çŠ¶: OpenCV ç‰ˆ 10â€“12 FPSã€Arcade ç‰ˆ 15 FPS ç¨‹åº¦ã€‚
- ç›®æ¨™: ã€Œè¨ˆæ¸¬â†’ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ç‰¹å®šâ†’å„ªå…ˆåº¦é †ã«æœ€é©åŒ–ã€ã‚’åå¾©ã—ã€å®‰å®šã—ã¦ 30 FPS ä»¥ä¸Šï¼ˆæœ€çµ‚ç›®æ¨™ 60 FPS è¿‘è¾ºï¼‰ã‚’ç›®æŒ‡ã™ã€‚
- åˆ¶ç´„/å‰æ:
  - ç”»é¢è§£åƒåº¦ã¯å¤‰æ›´ã—ãªã„ï¼ˆä¾‹: 4K ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ç¶­æŒï¼‰ã€‚
  - ã‚«ãƒ¡ãƒ©å…¥åŠ›ã¯ FHD/720p ã§å–å¾—å¯ã€‚æ¨è«–ã¯ç¸®å°ã—ã¦ã‚ˆã„ã€‚
  - CPU: 1ã‚³ã‚¢Ã—4ã‚½ã‚±ãƒƒãƒˆï¼ˆâ‰’4 è«–ç†/ç‰©ç†ã®ã©ã¡ã‚‰ã‹ã€è¦ç¢ºèªï¼‰ã€‚ã‚ªãƒ³ãƒãƒƒãƒ— GPU åˆ©ç”¨å¯èƒ½ã€‚

æˆåŠŸåŸºæº–ï¼ˆKPIï¼‰
- å®Ÿã‚²ãƒ¼ãƒ æ™‚ï¼ˆå²©ã‚ã‚Šãƒ»OSD ã‚ã‚Šãƒ»åŠ¹æœéŸ³ã‚ã‚Šï¼‰ã§ Arcade ç‰ˆ 30 FPS ä»¥ä¸Šï¼ˆä¸­é–“ç›®æ¨™ï¼‰ã€‚
- è¨ˆæ¸¬ãƒ­ã‚°ã§ã€(1) ã‚«ãƒ¡ãƒ©, (2) æ¨è«–, (3ã€œ5+9) æç”», (6) å½“ãŸã‚Šåˆ¤å®š, (7) ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ, (8) éŸ³ ã®å„å‡¦ç†æ™‚é–“æ¯”ç‡ãŒå¯è¦–åŒ–ã•ã‚Œã€æ”¹å–„ãŒå®šé‡çš„ã«ç¤ºã›ã‚‹ã€‚
- ä½è§£åƒåº¦æ¨è«–ã‚„ã‚¹ã‚­ãƒƒãƒ—ãªã©ã®å·¥å¤«ã§ã€Œä½“æ„Ÿã®é…å»¶/å“ä½ã€ã‚’æãªã‚ãªã„ã€‚

å…¨ä½“æ–¹é‡
1) æ­£ç¢ºãªè¨ˆæ¸¬åŸºç›¤ã‚’å…ˆã«å…¥ã‚Œã‚‹ï¼ˆä½ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã€CSV åé›†ã€OSD è¡¨ç¤ºï¼‰ã€‚
2) å®Ÿé¨“ãƒ¢ãƒ¼ãƒ‰ã‚’è¤‡æ•°ç”¨æ„ã—ã€å€‹åˆ¥ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã‚’åˆ†é›¢è©•ä¾¡ï¼ˆå¾®å°ãƒ™ãƒ³ãƒï¼‰ã€‚
3) å¤§ãã„ã‚‚ã®ï¼ˆå§¿å‹¢æ¨å®šâ†’æç”»â†’å½“ãŸã‚Šåˆ¤å®šâ†’ã‚¨ãƒ•ã‚§ã‚¯ãƒˆï¼‰ã‹ã‚‰å¯¾å‡¦ã€‚
4) ä¸¦åˆ—åŒ–ï¼ˆã‚¹ãƒ¬ãƒƒãƒ‰åŒ–/ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³åŒ–ï¼‰ã¨è§£åƒåº¦/é »åº¦ã®æœ€é©åŒ–ã‚’ä½µç”¨ã€‚
5) GPU ã¯å¯èƒ½ãªã¨ã“ã‚ã‹ã‚‰æ®µéšå°å…¥ï¼ˆMediaPipe delegate / Arcade ã®ãƒãƒƒãƒæç”» / OpenCLï¼‰ã€‚


1. è¨ˆæ¸¬è¨­è¨ˆï¼ˆInstrumentationï¼‰
- è¨ˆæ¸¬ãƒã‚¤ãƒ³ãƒˆï¼ˆ1ã€œ9 ã‚’ç¶²ç¾…ï¼‰
  1. camera_read: ã‚«ãƒ¡ãƒ© 1 ãƒ•ãƒ¬ãƒ¼ãƒ å–å¾—
  2. pose_infer: å§¿å‹¢æ¨å®šï¼ˆå‰å‡¦ç† resize/è‰²å¤‰æ›è¾¼ã¿/åˆ¥è¨ˆæ¸¬ã‚‚å¯ï¼‰
  3. draw_camera: ã‚«ãƒ¡ãƒ©ç”»åƒã®æç”»ï¼ˆã‚³ãƒ”ãƒ¼/ã‚¢ãƒƒãƒ—ã‚¹ã‚±ãƒ¼ãƒ«å«ã‚€ï¼‰
  4. draw_pose: æ¨å®šçµæœã®ã€‡æç”»
  5. draw_rocks: å²©ã®æç”»
  6. collide: å²©Ã—ä½“ã®æ¥è§¦åˆ¤å®š
  7. draw_fx: æ¥è§¦æ™‚ã‚¨ãƒ•ã‚§ã‚¯ãƒˆæç”»
  8. sfx: åŠ¹æœéŸ³ãƒˆãƒªã‚¬å‡¦ç†ï¼ˆå†ç”Ÿã¯éåŒæœŸï¼‰
  9. draw_osd: OSDï¼ˆFPS/ãƒ©ã‚¤ãƒ•/ã‚¹ã‚³ã‚¢/æ®‹ã‚Šæ™‚é–“ï¼‰
  - frame_total: 1 ãƒ•ãƒ¬ãƒ¼ãƒ ç·æ™‚é–“

- æ–¹å¼
  - time.perf_counter() ã§åŒºé–“è¨ˆæ¸¬ï¼ˆè»½é‡ï¼‰ã€‚
  - 1ãƒ•ãƒ¬ãƒ¼ãƒ ä¸­ã®å„åŒºé–“æ™‚é–“ã‚’ dict ã«é›†è¨ˆã€ãƒªãƒ³ã‚°ãƒãƒƒãƒ•ã‚¡ã§å¹³å‡åŒ–ã€‚
  - CSV ã¸è¿½è¨˜: timestamp, frame_id, camera_res, infer_res, model, backend(opencv/arcade), rocks, fps_target, å„åŒºé–“msã€‚
  - ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ OSD: ç›´è¿‘ N=60 ãƒ•ãƒ¬ãƒ¼ãƒ ç§»å‹•å¹³å‡ã¨å‰²åˆãƒãƒ¼è¡¨ç¤ºï¼ˆè² è·å¢—ã‚’é¿ã‘ç°¡ç´ ã«ï¼‰ã€‚

- å®Ÿè£…æ¡ˆ
  - src/game/profiler.pyï¼ˆæ–°è¦ï¼‰
    - Prof, Section: with Prof.section("pose_infer") ã§åŒºé–“è¨ˆæ¸¬
    - Prof.tick(frame_id, extra_meta={}) ã§ 1 ãƒ•ãƒ¬ãƒ¼ãƒ çµ‚äº†æ™‚ã« CSV å‡ºåŠ›ã‚ªãƒ—ã‚·ãƒ§ãƒ³
    - ãƒ¡ãƒ¢ãƒªå‰²å½“ã‚„ GC ã®å½±éŸ¿è¦³å¯Ÿã®ãŸã‚ã€æ™‚æŠ˜ forced GC è¨ˆæ¸¬ãƒ¢ãƒ¼ãƒ‰ã‚‚ç”¨æ„
  - main.py / gameplay.py / render.py / pose.py / collision.py ã«è»½é‡ãƒ•ãƒƒã‚¯ã‚’è¿½åŠ 
  - CLI ãƒ•ãƒ©ã‚°
    - --profile: è¨ˆæ¸¬æœ‰åŠ¹
    - --profile-csv path: CSV å‡ºåŠ›å…ˆ
    - --profile-osd: OSD ã«è¨ˆæ¸¬çµæœè¡¨ç¤º


2. å¾®å°ãƒ™ãƒ³ãƒï¼ˆåˆ†é›¢æ¤œè¨¼ãƒ¢ãƒ¼ãƒ‰ï¼‰
- bench_capture_infer: ã‚«ãƒ¡ãƒ©å–ã‚Šè¾¼ã¿â†’ï¼ˆå¯å¤‰è§£åƒåº¦ã« resizeï¼‰â†’å§¿å‹¢æ¨å®šã®ã¿ã€æç”»ãªã—
- bench_render_static: èµ·å‹•æ™‚ã« 1 æšã‚­ãƒ£ãƒ—ãƒãƒ£ or ç”»åƒèª­ã¿è¾¼ã¿â†’ä»¥é™ã¯ãƒ•ãƒ¬ãƒ¼ãƒ å›ºå®šã§ [3,4,5,9] ã®ã¿
- bench_collision: ãƒ©ãƒ³ãƒ€ãƒ å²© N å€‹ãƒ»ãƒ©ãƒ³ãƒ€ãƒ é–¢ç¯€ä½ç½® M ã‚»ãƒƒãƒˆã§è¡çªåˆ¤å®šã ã‘ãƒ«ãƒ¼ãƒ—
- bench_effects: ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«/ã‚¨ãƒ•ã‚§ã‚¯ãƒˆæç”»ã®ã¿
- bench_audio: åŠ¹æœéŸ³ã®ã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°è² è·æ¤œè¨¼ï¼ˆå®Ÿéš›ã®éŸ³ãƒ‡ãƒã‚¤ã‚¹ I/O ã®å½±éŸ¿è¦³å¯Ÿï¼‰
- ãã‚Œãã‚Œ uv scripts ã§ä¸€ç™ºèµ·å‹•ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹


3. å®Ÿé¨“ãƒãƒˆãƒªã‚¯ã‚¹ï¼ˆå„ªå…ˆåº¦é«˜â†’ä½ï¼‰
- å§¿å‹¢æ¨å®š
  - infer_input_size: {256, 192, 160, 128, 112}
  - model: models/pose_landmarker_{lite,full,heavy}.task
  - delegate: {CPU, GPU(å¯èƒ½ãªã‚‰)}
  - æ¨è«–é »åº¦: æ¯ãƒ•ãƒ¬ãƒ¼ãƒ  / 2 ãƒ•ãƒ¬ãƒ¼ãƒ ã« 1 å› / 3 ãƒ•ãƒ¬ãƒ¼ãƒ ã« 1 å›
  - å‰å‡¦ç†: BGRâ†’RGB, resize å®Ÿè£…ï¼ˆcv2 vs numpyï¼‰æ¯”è¼ƒã€OpenCL æœ‰åŠ¹åŒ–

- ã‚«ãƒ¡ãƒ©
  - capture_res: {1920x1080, 1280x720}
  - backend: {MSMF, DSHOW, V4L2 ç­‰ OS ä¾å­˜}ï¼ˆOS ã«å¿œã˜ã¦ï¼‰
  - å–ã‚Šè¾¼ã¿ã‚¹ãƒ¬ãƒƒãƒ‰: {å˜ä¸€, åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ãƒªãƒ³ã‚°ãƒãƒƒãƒ•ã‚¡}
  - ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ‰ãƒ­ãƒƒãƒ—æˆ¦ç•¥: æœ€æ–°å„ªå…ˆ / å³å¯†åŒæœŸ

- æç”»ï¼ˆOpenCV / Arcadeï¼‰
  - è¡¨ç¤ºè§£åƒåº¦: 4Kï¼ˆå›ºå®šï¼‰
  - å†…éƒ¨æç”»è§£åƒåº¦: {native(=4K), 1440p, 1080p, 720p} â†’ æœ€çµ‚ 4K ã¸ GPU æ‹¡å¤§ï¼ˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è§£åƒåº¦ã¯ç¶­æŒï¼‰
  - ãƒ†ã‚­ã‚¹ãƒˆæç”»: ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ‰/ç„¡ã€1å›ã® draw_call æ•°
  - ã€‡/å²©: ãƒãƒƒãƒæç”»ï¼ˆArcade ã® SpriteList / Geometryï¼‰ vs å€‹åˆ¥ draw

- å²©ã¨ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ/å½“ãŸã‚Šåˆ¤å®š
  - å²©æ•°: {50, 100, 200, 400}
  - ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç²’å­æ•°ä¸Šé™: {50, 100, 200}
  - åˆ¤å®šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ : å…¨æ¢ç´¢ vs ã‚°ãƒªãƒƒãƒ‰åˆ†å‰²/ç©ºé–“ãƒãƒƒã‚·ãƒ¥ vs ãƒ™ã‚¯ãƒˆãƒ«åŒ–
  

4. æœ€é©åŒ–æ–¹é‡ï¼ˆå„ªå…ˆåº¦é †ï¼‰
A) å§¿å‹¢æ¨å®š
- å…¥åŠ›ç¸®å°ï¼ˆinference only downscaleï¼‰: 720p/1080p å–ã‚Šè¾¼ã¿â†’æ¨è«–ã¯ 160ã€œ192 è¾ºã‚Šã§å®Ÿé¨“ã€‚
- ä½é »åº¦æ¨è«–: æ¨è«–ã¯ 30/2=15Hz ã§ã‚‚ã€æç”»ã¯ 30Hzã€è£œé–“ã¯ã€Œå‰å›ã®æ¨å®šã‚’ä¿ã¤ã€ã€‚
- ROI ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°: å‰ãƒ•ãƒ¬ãƒ¼ãƒ ã®é–¢ç¯€ bbox ã‚’æ‹¡å¤§ã—ã¦åˆ‡ã‚Šå‡ºã—â†’å°ã•ãæ¨è«–â†’å…¨ä½“åº§æ¨™ã¸æˆ»ã™ã€‚
- ãƒ¢ãƒ‡ãƒ«é¸æŠ: åŸºæœ¬ lite ã‚’æ—¢å®šã€è² è·ã«å¿œã˜ã¦ full/heavy åˆ‡æ›¿ã€‚
- GPU delegateï¼ˆå¯èƒ½ãªã‚‰ï¼‰: MediaPipe Tasks ã® GPU ã‚µãƒãƒ¼ãƒˆï¼ˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ä¾å­˜ï¼‰ã€‚
- å‰å‡¦ç†é«˜é€ŸåŒ–: cv2.resize ã®æœ€é©è£œé–“é¸æŠï¼ˆINTER_AREA/LINEARï¼‰ã€è‰²å¤‰æ› cvtColor ã® OpenCL æœ‰åŠ¹åŒ–ã€‚

B) æç”»ï¼ˆ3ã€œ5ï¼‹9ï¼‰
- Arcade ã®æ´»ç”¨æœ€å¤§åŒ–: SpriteList / batch ã§ draw call å‰Šæ¸›ã€Geometry/instancing ã‚’æ¤œè¨ã€‚
- ãƒ†ã‚­ã‚¹ãƒˆæç”»ã®æœ€å°åŒ–: ãƒ•ãƒ¬ãƒ¼ãƒ æ¯ã«å¤‰ã‚ã‚‰ãªã„æ–‡å­—åˆ—ã¯ãƒ†ã‚¯ã‚¹ãƒãƒ£åŒ–ã—ã¦å†åˆ©ç”¨ã€æ•°å€¤ã ã‘æ›´æ–°ã€‚
- å††/å²©ã®æç”»: é ‚ç‚¹ã‚’äº‹å‰ç”Ÿæˆã€æç”»ã¯ transform ã ã‘å¤‰æ›´ï¼ˆã‚·ã‚§ãƒ¼ãƒ€ or å¤‰æ›è¡Œåˆ—ï¼‰ã€‚
- ã‚ªãƒ•ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ä½è§£åƒåº¦åˆæˆâ†’4K ã¸æ‹¡å¤§: ç”»é¢è§£åƒåº¦ã¯ç¶­æŒã—ã¤ã¤å†…éƒ¨ FBO ã‚’ä½è§£åƒåº¦ã§æç”»ã—ã€æœ€çµ‚ãƒ‘ã‚¹ã§ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—ï¼ˆä½“æ„Ÿå“è³ªã¨æ€§èƒ½ã®æŠ˜è¡·ï¼‰ã€‚
- OpenCV ç‰ˆã¯ draw å‡¦ç†ã®ã‚³ãƒ”ãƒ¼å›æ•°å‰Šæ¸›ã€putText ã®å‘¼ã³å‡ºã—å›æ•°å‰Šæ¸›ï¼ˆã¾ã¨ã‚æç”»ï¼‰ã€‚

C) å½“ãŸã‚Šåˆ¤å®šï¼ˆ6ï¼‰
- æ—©æœŸé™¤å¤–: åŠå¾„å’Œã®äºŒä¹—ã¨è·é›¢äºŒä¹—ã§ sqrt ã‚’å›é¿ã€‚
- ç©ºé–“åˆ†å‰²: ãƒ¦ãƒ‹ãƒ•ã‚©ãƒ¼ãƒ ã‚°ãƒªãƒƒãƒ‰ or ç©ºé–“ãƒãƒƒã‚·ãƒ¥ã§ã€ŒåŒä¸€/è¿‘å‚ã‚»ãƒ«ã€ã®ã¿åˆ¤å®šã€‚
- ãƒ™ã‚¯ãƒˆãƒ«åŒ–: NumPy ã§è¤‡æ•°å²©ã¨ã®è·é›¢ã‚’ã¾ã¨ã‚ã¦è¨ˆç®—ï¼ˆSIMD åŠ¹æœï¼‰ã€‚
- ä¸¦åˆ—: å²©ãƒªã‚¹ãƒˆã‚’åˆ†å‰²ã—ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ—ãƒ¼ãƒ«ã§é›†è¨ˆï¼ˆGIL ã¯ NumPy/Cython éƒ¨åˆ†ã§è§£æ”¾ã•ã‚Œã‚‹è¦‹è¾¼ã¿ï¼‰ã€‚

D) ã‚¨ãƒ•ã‚§ã‚¯ãƒˆï¼ˆ7ï¼‰
- ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã®ä¸Šé™ã¨å¯¿å‘½ç®¡ç†ã€ãƒ—ãƒ¼ãƒ«å†åˆ©ç”¨ã§ GC/alloc ã‚’æŠ‘åˆ¶ã€‚
- Arcade ã® ParticleEmitter ã‚’ä½¿ã„ã€æ›´æ–°/æç”»ã®ãƒãƒƒãƒåŒ–ã€‚

E) ã‚«ãƒ¡ãƒ©ï¼ˆ1ï¼‰
- åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã§ VideoCapture ã‚’å›ã—ã€æœ€æ–°ãƒ•ãƒ¬ãƒ¼ãƒ ã®ã¿ã‚’å…±æœ‰ï¼ˆDrop Oldï¼‰ã€‚
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é¸æŠï¼ˆWindows: MSMF/DSHOWã€Linux: V4L2ï¼‰ã€‚
- ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºæœ€å°åŒ–ã€éœ²å…‰/ã‚ªãƒ¼ãƒˆãƒ›ãƒ¯ã‚¤ãƒˆãƒãƒ©ãƒ³ã‚¹å›ºå®šã§æºã‚‰ãã‚’æ¸›ã‚‰ã™ã€‚

F) åŠ¹æœéŸ³ï¼ˆ8ï¼‰
- äº‹å‰ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ã€‚çŸ­ã„ SE ã¯åŒæ™‚ç™ºéŸ³æ•°ã®ä¸Šé™/ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³å°å…¥ã§ã‚¹ãƒ‘ãƒ æŠ‘æ­¢ã€‚
- ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã¯åŸºæœ¬è»½ã„ãŒã€ãƒˆãƒªã‚¬å¯†åº¦ã‚’æŠ‘åˆ¶ï¼ˆN ãƒ•ãƒ¬ãƒ¼ãƒ ã‚ãŸã‚Šæœ€å¤§ M å›ï¼‰ã€‚

G) OSDï¼ˆ9ï¼‰
- æ•°å­—ãƒ»å›ºå®šæ–‡å­—ã¯ãƒ†ã‚¯ã‚¹ãƒãƒ£åŒ–ã€æ¡å¤‰åŒ–æ™‚ã®ã¿æ›´æ–°ã€‚
- è¤‡æ•°ãƒ†ã‚­ã‚¹ãƒˆã‚’ 1 æç”»ã«ã¾ã¨ã‚ã‚‹ï¼ˆArcade ã® Text API æœ€é©åŒ–ï¼‰ã€‚


5. ä¸¦åˆ—åŒ–è¨­è¨ˆï¼ˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼‰
- ã‚¹ãƒ†ãƒ¼ã‚¸åˆ†å‰²
  - Captureï¼ˆåˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ï¼‰â†’ QueueA â†’ Inferï¼ˆåˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã€ä½é »åº¦ï¼‰â†’ QueueB â†’ Render/Mainï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰
- æ–¹é‡
  - å„ã‚¹ãƒ†ãƒ¼ã‚¸ã¯æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å‚ç…§ï¼ˆå¤ã„ãƒ•ãƒ¬ãƒ¼ãƒ ã¯ç ´æ£„ï¼‰ã€‚
  - ãƒ•ãƒ¬ãƒ¼ãƒ  ID ã¨ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã§æ•´åˆæ€§ã‚’ç®¡ç†ã€æç”»ã¯ã€Œæœ€æ–°ã®æ¨è«–çµæœ Ã— æœ€æ–°ãƒ•ãƒ¬ãƒ¼ãƒ ã€ã‚’åˆæˆã€‚
  - Python ã‚¹ãƒ¬ãƒƒãƒ‰: OpenCV I/O ã¨ MediaPipe/C++ éƒ¨åˆ†ã¯ GIL è§£æ”¾ãŒè¦‹è¾¼ã‚ã‚‹ãŸã‚æœ‰åŠ¹ã€‚
  - ã•ã‚‰ã« CPU è² è·ãŒé«˜ã„ã¨ãã¯ multiprocessing ã§æ¨è«–ã‚’åˆ†é›¢ï¼ˆå…±æœ‰ãƒ¡ãƒ¢ãƒª + è»½é‡åœ§ç¸®ã§å—ã‘æ¸¡ã—ï¼‰ã€‚


6. GPU æ´»ç”¨
- MediaPipe Tasks ã® GPU delegateï¼ˆç’°å¢ƒä¾å­˜ï¼‰ã€‚å¯èƒ½ãªã‚‰æœ‰åŠ¹åŒ–ã‚’å®Ÿé¨“ã€‚
- OpenCV ã® OpenCLï¼ˆcv.ocl.setUseOpenCL(True) ã§ç¢ºèªï¼‰ã€‚resize/cvtColor ãŒé€Ÿããªã‚‹å ´åˆã‚ã‚Šã€‚
- Arcade ã¯ OpenGL ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã€‚SpriteList/Geometry ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚·ãƒ³ã‚°/ãƒãƒƒãƒã‚’æœ€å¤§æ´»ç”¨ã€‚
- å°†æ¥çš„ã«ã¯ã€Œå††ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ç”¨ã®ç°¡æ˜“ã‚·ã‚§ãƒ¼ãƒ€ + ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹é…åˆ—ã€ã§ ã€‡ ã¨å²©ã‚’ 1ã€œ2 draw call ã«é›†ç´„ã€‚


7. ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ï¼ˆå®Ÿæ–½é †ï¼‰
- Phase 0: åŸºç·š
  - (P0-1) è¨ˆæ¸¬åŸºç›¤ï¼ˆprofiler.pyï¼‰å°å…¥ã€main/render/pose/collision ã¸åŒºé–“ãƒ•ãƒƒã‚¯
  - (P0-2) è¨ˆæ¸¬ CSV / OSD å‡ºåŠ›ã€uv ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ 
  - (P0-3) ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ¸¬å®šï¼ˆOpenCV/Arcade ä¸¡æ–¹ã€å®Ÿã‚²ãƒ¼ãƒ ï¼‰

- Phase 1: å§¿å‹¢æ¨å®šã®æœ€é©åŒ–
  - (P1-1) æ¨è«–å…¥åŠ›ç¸®å°ã®ã‚¹ã‚¤ãƒ¼ãƒ—ï¼ˆ128ã€œ256ï¼‰
  - (P1-2) æ¨è«–ã‚¹ã‚­ãƒƒãƒ—ï¼ˆ2ã€œ3ãƒ•ãƒ¬ãƒ¼ãƒ ã«1å›ï¼‰
  - (P1-3) ãƒ¢ãƒ‡ãƒ« lite ã‚’æ—¢å®šåŒ–ã€å¿…è¦æ™‚ã« full/heavy åˆ‡æ›¿
  - (P1-4) OpenCL æœ‰åŠ¹åŒ–æœ‰ç„¡æ¯”è¼ƒ
  - (P1-5) å¯èƒ½ãªã‚‰ GPU delegate ã®å¯å¦ã¨åŠ¹æœæ¸¬å®š

- Phase 2: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³åŒ–/ã‚¹ãƒ¬ãƒƒãƒ‰åŒ–
  - (P2-1) Capture ã‚¹ãƒ¬ãƒƒãƒ‰ + æœ€æ–°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒãƒƒãƒ•ã‚¡
  - (P2-2) Infer ã‚¹ãƒ¬ãƒƒãƒ‰ + ä½é »åº¦ + æœ€æ–°çµæœå…±æœ‰
  - (P2-3) ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¯ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã§ä¸€è²«

- Phase 3: æç”»æœ€é©åŒ–ï¼ˆ3ã€œ5ï¼‹9ï¼‰
  - (P3-1) Arcade: SpriteList/Geometry ã¸ç§»è¡Œã€ãƒ†ã‚­ã‚¹ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥
  - (P3-2) OpenCV: putText ã¾ã¨ã‚ã€ã‚³ãƒ”ãƒ¼å‰Šæ¸›
  - (P3-3) ä½è§£åƒåº¦ FBO â†’ 4K æ‹¡å¤§ï¼ˆæœ€çµ‚ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦/ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã¯ 4K ç¶­æŒï¼‰

- Phase 4: å½“ãŸã‚Šåˆ¤å®š/ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
  - (P4-1) ç©ºé–“ãƒãƒƒã‚·ãƒ¥å°å…¥ + æ—©æœŸé™¤å¤–
  - (P4-2) ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã®ãƒ—ãƒ¼ãƒ«åŒ–ãƒ»ä¸Šé™

- Phase 5: ä»•ä¸Šã’
  - (P5-1) å„æœ€é©åŒ–ã‚ªãƒ³/ã‚ªãƒ•ã®ã‚¢ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¯”è¼ƒ
  - (P5-2) æ§‹æˆåˆ¥ãƒ—ãƒªã‚»ãƒƒãƒˆç”¨æ„ï¼ˆä½è² è·/æ¨™æº–/é«˜ç”»è³ªï¼‰
  - (P5-3) ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™


8. æˆæœç‰©ï¼ˆã“ã®è¨ˆç”»ã§æ–°è¦ã«è¿½åŠ /å¤‰æ›´ã™ã‚‹æƒ³å®šï¼‰
- æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«
  - src/game/profiler.py: è»½é‡ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ©ï¼ˆåŒºé–“è¨ˆæ¸¬ã€CSVã€OSD æ”¯æ´ï¼‰
  - scripts/bench_capture_infer.py: å–ã‚Šè¾¼ã¿+æ¨è«–ãƒ™ãƒ³ãƒ
  - scripts/bench_render_static.py: å›ºå®šãƒ•ãƒ¬ãƒ¼ãƒ ã§æç”»ãƒ™ãƒ³ãƒï¼ˆOpenCV/Arcadeï¼‰
  - scripts/bench_collision.py: è¡çªåˆ¤å®šãƒ™ãƒ³ãƒ
  - scripts/bench_effects.py: ã‚¨ãƒ•ã‚§ã‚¯ãƒˆæç”»ãƒ™ãƒ³ãƒ
- æ—¢å­˜å¤‰æ›´
  - main.py / render.py / pose.py / collision.py / gameplay.py: è¨ˆæ¸¬ãƒ•ãƒƒã‚¯ã¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¿½åŠ 
  - pyproject.toml: uv scripts ã‚’è¿½åŠ 


9. ãƒªã‚¹ã‚¯ã¨å¯¾ç­–
- MediaPipe GPU delegate ãŒç’°å¢ƒã§å‹•ã‹ãªã„ â†’ CPU æœ€é©åŒ–&ä½é »åº¦æ¨è«–ã‚’ä¸»è»¸ã«ã€‚
- 4K è¡¨ç¤ºã®æç”»è² è·ãŒé«˜ã„ â†’ å†…éƒ¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°è§£åƒåº¦å¯å¤‰ + æœ€çµ‚ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—ï¼ˆå“è³ªã¨æ€§èƒ½ã®æŠ˜è¡·ï¼‰ã€‚
- Python GIL ã®å½±éŸ¿ â†’ C++/NumPy åŒºé–“ä¸»ä½“ãªã®ã§ã‚¹ãƒ¬ãƒƒãƒ‰ã§åŠ¹æœã‚ã‚Šã€‚å¿…è¦ãªã‚‰ multiprocessingã€‚
- ã‚«ãƒ¡ãƒ©ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å·®ç•° â†’ OS ã”ã¨ã®æœ€é©è¨­å®šã‚’ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã§æ¤œè¨¼ã€‚


10. ãƒ†ã‚¹ãƒˆ/æ¤œè¨¼è¨ˆç”»
- å„ Phase æ¯ã«ã€ŒåŒæ¡ä»¶ã§è¨ˆæ¸¬â†’CSVâ†’ã‚°ãƒ©ãƒ•åŒ–ã€ã€‚
- ãƒ©ãƒ³ãƒ€ãƒ ç¨®å›ºå®šã§æ¯”è¼ƒå¯èƒ½ã«ã™ã‚‹ã€‚
- è¨ˆæ¸¬ OS/ãƒã‚·ãƒ³æƒ…å ±ï¼ˆCPU/GPU/ãƒ‰ãƒ©ã‚¤ãƒ/OpenCLå¯å¦ï¼‰ã‚’ CSV ã«è¨˜éŒ²ã€‚


11. æ¬¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿè£…ã‚¿ã‚¹ã‚¯è©³ç´°ï¼‰
- [x] P0-1: profiler.py ã®å®Ÿè£…ï¼ˆwith åŒºé–“ã€é›†è¨ˆã€CSVã€OSDï¼‰
- [x] P0-2: main/render/pose/collision ã¸æœ€å°ãƒ•ãƒƒã‚¯é…ç½®
- [x] P0-3: uv script è¿½åŠ ï¼ˆbench_* èµ·å‹•ï¼‰
- [x] P0-4: ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ¸¬å®šï¼ˆOpenCV/Arcadeã€FHD/720pã€rocks=100ï¼‰
- [x] P1-1: æ¨è«–å…¥åŠ›ç¸®å°ã‚¹ã‚¤ãƒ¼ãƒ—ï¼ˆå®Œäº†ã€12.2 ã«çµæœã‚ã‚Šï¼‰
- [x] P1-2: æ¨è«–ã‚¹ã‚­ãƒƒãƒ—å°å…¥ï¼ˆä¸è¦ã®ãŸã‚å®Ÿæ–½ã—ãªã„ï¼Won't Doï¼‰
- [x] P2-1: Capture/Infer ã®ã‚¹ãƒ¬ãƒƒãƒ‰åŒ– + æœ€æ–°å„ªå…ˆã‚­ãƒ¥ãƒ¼ï¼ˆå®Œäº†ã€--pipeline ã§æœ‰åŠ¹åŒ–ã€‚src/game/pipeline.py ã‚’è¿½åŠ ã—ã€OpenCV/Arcade ä¸¡çµŒè·¯ã«çµ±åˆï¼‰
- [x] P3-1: Arcade ã® SpriteList/ãƒ†ã‚­ã‚¹ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆå®Ÿè£…å®Œäº†ãƒ»è©•ä¾¡æ¸ˆã¿ï¼‰
  - Text: draw_text ã‹ã‚‰ Text ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸å…¨é¢ç§»è¡Œï¼ˆHUD/ã‚¿ã‚¤ãƒãƒ¼/ã‚¹ã‚³ã‚¢/ãƒ©ã‚¤ãƒ•ï¼‰å®Œäº†ã€‚8æ–¹å‘ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³æœ€é©åŒ–ã‚‚å®Ÿè£…ã€‚
  - Rocks: SpriteList ã¸ã®ç§»è¡Œå®Œäº†ã€‚RockSprite ã‚¯ãƒ©ã‚¹ã¨ãƒãƒƒãƒæç”»ã‚’å®Ÿè£…ã€‚
  - Circles: CircleGeometry ã‚¯ãƒ©ã‚¹ã§ãƒãƒƒãƒæç”»ã®åŸºç›¤ã‚’å®Ÿè£…ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä»˜ãï¼‰ã€‚
  - OSD: ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ© OSD ã¯ã™ã§ã« Text ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–æ¸ˆã¿ã€‚
  - ãƒ™ãƒ³ãƒ: scripts/bench_render_static.py ã‚’å¤§å¹…å¼·åŒ–ã—ã€A/B æ¯”è¼ƒãƒ»è¤‡æ•°æ¡ä»¶ãƒ†ã‚¹ãƒˆã«å¯¾å¿œã€‚
  - è¨ˆæ¸¬çµæœï¼ˆ10sã€--skip-first 1ã€2025-01-19 æœ€çµ‚ç‰ˆï¼‰:
    - å…¨ä½“: baseline 38.18ms (26.19 fps) â†’ optimized 34.13ms (29.30 fps) = -4.05ms (+3.11 fps) âœ… æ”¹å–„
    - draw_camera: 3.71ms â†’ 2.22ms (-1.49ms) = 40% æ”¹å–„
    - draw_pose: 0.74ms â†’ 0.50ms (-0.24ms) = 32% æ”¹å–„
    - draw_osd: 6.26ms â†’ 6.15ms (-0.11ms) = 2% æ”¹å–„
    - draw_rocks: 0.14ms â†’ 0.45ms (+0.31ms) = ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆç®¡ç†ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰
    - draw_fx: 0.21ms â†’ 1.21ms (+1.00ms) = ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè² è·ã®é•ã„
  - çµè«–: å²©ã®å¯è¦–æ€§å•é¡Œã‚’ä¿®æ­£å¾Œã€å…¨ä½“ã§ +3.11 fps ã®æ€§èƒ½å‘ä¸Šã‚’é”æˆã€‚--optimized-rendering ãƒ•ãƒ©ã‚°ã§é¸æŠå¯èƒ½ã€‚

## P3-1 è©³ç´°è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆ

### å®Ÿè£…ã‚µãƒãƒªãƒ¼

#### 1. ãƒ†ã‚­ã‚¹ãƒˆæœ€é©åŒ– âœ… **å®Œäº†**
- **8æ–¹å‘ãƒ†ã‚­ã‚¹ãƒˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³**: 4æ–¹å‘ã‹ã‚‰8æ–¹å‘ã¸ã®æ‹¡å¼µã§æ—¥æœ¬èªãƒ†ã‚­ã‚¹ãƒˆã®æ»‘ã‚‰ã‹ãªæç”»ã‚’å®Ÿç¾
- **äº‹å‰å‰²ã‚Šå½“ã¦ãƒ†ã‚­ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**: `arcade.draw_text` ã‹ã‚‰å†åˆ©ç”¨å¯èƒ½ãª `arcade.Text` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸å®Œå…¨ç§»è¡Œ
- **ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥**: ä¸»è¦UIè¦ç´ ç”¨ã®äº‹å‰å‰²ã‚Šå½“ã¦ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ:
  - ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ãƒ†ã‚­ã‚¹ãƒˆï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ä»˜ãï¼‰
  - HUDè¦ç´ ï¼ˆã‚¿ã‚¤ãƒãƒ¼ã€ã‚¹ã‚³ã‚¢ã€ãƒ©ã‚¤ãƒ•ï¼‰ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ä»˜ãï¼‰
  - ã‚¤ãƒ™ãƒ³ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆé ­éƒ¨/æ‰‹éƒ¨ãƒ’ãƒƒãƒˆï¼‰ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ä»˜ãï¼‰
  - ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ç”»é¢ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ä»˜ãï¼‰
- **å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ›´æ–°**: ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã¿æ›´æ–°ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†ä½œæˆãªã—

#### 2. å²©æç”»æœ€é©åŒ– âœ… **å®Ÿè£…æ¸ˆã¿**
- **RockSprite ã‚¯ãƒ©ã‚¹**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸãƒ†ã‚¯ã‚¹ãƒãƒ£ä»˜ãã‚¹ãƒ—ãƒ©ã‚¤ãƒˆè¡¨ç¾
- **RockSpriteList**: åŠ¹ç‡çš„ãªè¿½åŠ /å‰Šé™¤ã«ã‚ˆã‚‹ãƒãƒƒãƒæç”»ã‚·ã‚¹ãƒ†ãƒ 
- **ãƒ†ã‚¯ã‚¹ãƒãƒ£ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: PIL ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä»˜ãå²©ã‚¿ã‚¤ãƒ—åˆ¥ãƒ†ã‚¯ã‚¹ãƒãƒ£ç”Ÿæˆ
- **ãƒ’ãƒƒãƒˆã‚¨ãƒ•ã‚§ã‚¯ãƒˆçµ±åˆ**: ãƒ’ãƒƒãƒˆã—ãŸå²©ã®è¦–è¦šåŠ¹æœç¶­æŒ

#### 3. å††æç”»æœ€é©åŒ– âœ… **å®Ÿè£…æ¸ˆã¿**
- **CircleGeometry ã‚¯ãƒ©ã‚¹**: ãƒãƒƒãƒå††æç”»ã®ã‚¤ãƒ³ãƒ•ãƒ©
- **ã‚¸ã‚ªãƒ¡ãƒˆãƒªãƒãƒƒãƒãƒ³ã‚°**: åŠå¾„åˆ¥å††ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚·ãƒ³ã‚°å¯¾å¿œ
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å¯¾å¿œ**: å€‹åˆ¥æç”»å‘¼ã³å‡ºã—ã¸ã®å„ªé›…ãªåŠ£åŒ–

#### 4. å¼·åŒ–ã•ã‚ŒãŸãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ âœ… **å®Ÿè£…æ¸ˆã¿**
- **å¼·åŒ–ã•ã‚ŒãŸ bench_render_static.py**: åŒ…æ‹¬çš„A/Bãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- **è¤‡æ•°ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰**: æœ€é©åŒ– vs ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã€ç•°ãªã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®æ¯”è¼ƒ
- **è‡ªå‹•åˆ†æ**: compare_profiles.py ã¨ã®çµ±åˆã«ã‚ˆã‚‹è©³ç´°ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### æ€§èƒ½è©•ä¾¡

#### ãƒ†ã‚¹ãƒˆæ§‹æˆ
- **æœŸé–“**: 10ç§’ï¼ˆå„ãƒ†ã‚¹ãƒˆï¼‰
- **åˆå›ã‚¹ã‚­ãƒƒãƒ—**: 1ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆåˆæœŸåŒ–ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ï¼‰
- **æ¨è«–ã‚µã‚¤ã‚º**: 192px
- **ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°**: å…¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒŸãƒ³ã‚°æœ‰åŠ¹
- **æ—¥ä»˜**: 2025-01-19

#### çµæœ: ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ vs æœ€é©åŒ–

```
å…¨ä½“æ€§èƒ½:
  ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³:   38.18 ms (26.19 fps)
  æœ€é©åŒ–ç‰ˆ:      34.13 ms (29.30 fps)  
  å·®åˆ†:         -4.05 ms (+3.11 fps) âœ… é«˜é€ŸåŒ–

ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ†æ:
  draw_camera:  3.71ms â†’ 2.22ms (-1.49ms) âœ… 40% æ”¹å–„
  draw_pose:    0.74ms â†’ 0.50ms (-0.24ms) âœ… 32% æ”¹å–„  
  draw_osd:     6.26ms â†’ 6.15ms (-0.11ms) âœ… 2% æ”¹å–„
  camera_read:  1.12ms â†’ 0.95ms (-0.18ms) âœ… 16% æ”¹å–„
  draw_rocks:   0.14ms â†’ 0.45ms (+0.31ms) âŒ ç®¡ç†ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰
  draw_fx:      0.21ms â†’ 1.21ms (+1.00ms) âŒ ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå·®ç•°
```

### åˆ†æã¨æ´å¯Ÿ

#### âœ… **æˆåŠŸã—ãŸæœ€é©åŒ–**
1. **ã‚«ãƒ¡ãƒ©æç”»**: 40% æ”¹å–„ (-1.49ms)
2. **å††æç”»**: 32% æ”¹å–„ (-0.24ms)
3. **HUDæç”»**: 2% æ”¹å–„ (-0.11ms)
4. **ã‚«ãƒ¡ãƒ©èª­ã¿å–ã‚Š**: 16% æ”¹å–„ (-0.18ms)

#### ğŸ“Š **å®Ÿè£…å“è³ªè©•ä¾¡**
- ã‚¯ãƒªãƒ¼ãƒ³ã§ä¿å®ˆå¯èƒ½ãªã‚³ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- APIäº’æ›æ€§ã®ãŸã‚ã®é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿæ§‹
- åŒ…æ‹¬çš„ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¤ãƒ³ãƒ•ãƒ©
- è©³ç´°ãªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°çµ±åˆ

### æ¨å¥¨äº‹é …

#### ç¾åœ¨ã®å®Ÿè£…ç”¨
1. **ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**: å²©æ•° > ã—ãã„å€¤ï¼ˆä¾‹: 20å€‹ä»¥ä¸Šï¼‰æ™‚ã®ã¿æœ€é©åŒ–æç”»ä½¿ç”¨
2. **ãƒ†ã‚¯ã‚¹ãƒãƒ£ãƒ—ãƒ¼ãƒªãƒ³ã‚°**: ä½œæˆã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰å‰Šæ¸›ã®ãŸã‚ã®å…±é€šå²©ãƒ†ã‚¯ã‚¹ãƒãƒ£äº‹å‰ç”Ÿæˆ
3. **é…å»¶ãƒ­ãƒ¼ãƒ‰**: æ€§èƒ½ãƒ¡ãƒªãƒƒãƒˆãŒã‚³ã‚¹ãƒˆã‚’ä¸Šå›ã‚‹å ´åˆã®ã¿ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆä½œæˆ

#### é«˜è² è·ã‚·ãƒŠãƒªã‚ªç”¨
ä»¥ä¸‹ã®å ´åˆã«æœ€é©åŒ–åŠ¹æœã‚’ç™ºæ®:
- **å²©æ•°**: 50å€‹ä»¥ä¸ŠåŒæ™‚
- **ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå¼·åº¦**: é‡ã„ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆæœ‰åŠ¹
- **ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼**: 2åä»¥ä¸Šã®ãƒ‡ãƒ¥ãƒ—ãƒªã‚±ãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ‰

### çµè«–

**P3-1 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: âœ… å®Œäº†ï¼ˆè‰¯å¥½ãªçµæœï¼‰**

å®Ÿè£…ã¯é«˜åº¦ãªArcadeæœ€é©åŒ–æŠ€è¡“ã‚’æˆåŠŸè£ã«å®Ÿè¨¼ã—ã€æ¸¬å®šå¯èƒ½ãªæ€§èƒ½å‘ä¸Šã‚’å®Ÿç¾ã€‚åŒ…æ‹¬çš„ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚·ã‚¹ãƒ†ãƒ ã¯å°†æ¥ã®æœ€é©åŒ–è©•ä¾¡ã«éå¸¸ã«æœ‰ç”¨ã€‚

**æ¨å¥¨**: æœ€é©åŒ–ã‚’ `--optimized-rendering` ãƒ•ãƒ©ã‚°ã«ã‚ˆã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã¨ã—ã¦ä¿æŒã—ã€ä»–ã®é«˜ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆæœ€é©åŒ–ã‚’ç¶™ç¶šã€‚
- [x] P4-1: ç©ºé–“ãƒãƒƒã‚·ãƒ¥ + ãƒ™ã‚¯ãƒˆãƒ«åŒ–ï¼ˆç¾çŠ¶ä¸è¦ã€ä¸»ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ãŒå§¿å‹¢æ¨å®šã®ãŸã‚ï¼Won't Doï¼‰
- [ ] P5-1: ã‚¢ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¯”è¼ƒã¾ã¨ã‚ & ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ


è£œè¶³ãƒ»å®Ÿè£…ãƒ¡ãƒ¢
- CSV ä¾‹: ts,frame,id,camera_res,infer_res,model,backend,rocks,fps,[camera_read,pose_infer,draw_camera,draw_pose,draw_rocks,collide,draw_fx,sfx,draw_osd,frame_total]
- ä½é »åº¦æ¨è«–ã®æ³¨æ„: å…¥åŠ›é…å»¶ã‚’æ„Ÿã˜ã‚‹ãªã‚‰ã€è£œé–“ï¼ˆæ‰‹/é ­ã®ç·šå½¢è£œé–“ï¼‰ã‚„ã€å²©é€Ÿåº¦ã«å¿œã˜ãŸåˆ¤å®šä½™è£•ã‚’èª¿æ•´ã€‚
- ç©ºé–“ãƒãƒƒã‚·ãƒ¥: ã‚»ãƒ«ã‚µã‚¤ã‚º â‰’ å²©ã®æœ€å¤§ç›´å¾„ã€ã‚»ãƒ«â†’å²©ID ã® dictã€å„ä½“ãƒ‘ãƒ¼ãƒ„ã¯è‡ªã‚»ãƒ«ã¨ 8 è¿‘å‚ã®ã¿ç…§åˆã€‚
- ã€‡/å²©ã®æç”»: å††ã¯ä¸‰è§’ãƒ•ã‚¡ãƒ³/ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚·ãƒ³ã‚°ã§ GPU ã«å¯„ã›ã‚‹ã¨åŠ¹æœå¤§ï¼ˆArcade å´ã® API èª¿æŸ»ï¼‰ã€‚

---
ã“ã® plan.md ã«æ²¿ã£ã¦ã€ã¾ãšã¯ã€Œè¨ˆæ¸¬åŸºç›¤ï¼ˆPhase 0ï¼‰ã€ã‚’æœ€å„ªå…ˆã§å®Ÿè£…ã—ã¾ã™ã€‚


12. Phase 0 ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è¨ˆæ¸¬ é€Ÿå ±ï¼ˆ2025-09-23ï¼‰ãŠã‚ˆã³è¿½åŠ çµæœï¼ˆduplicate/è§£åƒåº¦æ¯”è¼ƒï¼‰
- å®Ÿè¡Œæ¡ä»¶ï¼ˆå…±é€šï¼‰
  - capture: 1280x720ï¼ˆopen_camera()ã®æ—¢å®šå€¤ï¼‰
  - model: models/pose_landmarker_lite.taskï¼ˆTasks API, multi-personï¼‰
  - players: é€šå¸¸ï¼ˆ--duplicate ãªã—ï¼‰
  - è¨ˆæ¸¬: --profile, --profile-csv, --max-seconds 10

- OpenCV ç‰ˆï¼ˆruns/baseline_opencv_10s.csvï¼‰
  - pose_infer: ãŠãŠã‚€ã­ 56ã€œ62 ms/ãƒ•ãƒ¬ãƒ¼ãƒ ã€ãŸã¾ã« 80 ms è¶…ã®ã‚¹ãƒ‘ã‚¤ã‚¯
  - draw_cameraï¼ˆimshowï¼‰: 0.7ã€œ1.3 ms
  - draw_pose/draw_rocks/draw_osd: å„ 0.6ã€œ1.4 ms ç¨‹åº¦
  - draw_fx: ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç™ºç”Ÿæ™‚ã« 49ã€œ57 ms ç¨‹åº¦ã®å¤§ããªè² è·ã€‚ã“ã‚Œã«ã‚ˆã‚Š frame_ms ãŒ 125ã€œ140 msï¼ˆç´„ 7ã€œ8 FPSï¼‰ã¾ã§è½ã¡ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ãŒæ•£ç™º
  - collide: é€šå¸¸ 0.01ã€œ0.3 ms ç¨‹åº¦ï¼ˆç¾çŠ¶ã®å²©æ•°æ¡ä»¶ã§ã¯è»½ã„ï¼‰
  - ç·åˆ: ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãŒå‡ºã¦ã„ãªã„ãƒ•ãƒ¬ãƒ¼ãƒ ã¯ 70ã€œ85 msï¼ˆç´„ 12ã€œ14 FPSï¼‰ã€‚ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã¯ pose_inferã€æ¬¡ç‚¹ã§ draw_fx ã®ã‚¹ãƒ‘ã‚¤ã‚¯

- Arcade ç‰ˆï¼ˆruns/baseline_arcade_10s.csvï¼‰
  - pose_infer: ç´„ 56ã€œ60 msï¼ˆOpenCV ç‰ˆã¨åŒç¨‹åº¦ï¼‰
  - draw_cameraï¼ˆpyglet blitï¼‰: 3ã€œ4 ms å‰å¾Œ
  - draw_pose/draw_rocks/draw_osd: 0.2ã€œ0.8 ms ç¨‹åº¦
  - åˆå›ãƒ•ãƒ¬ãƒ¼ãƒ ã® draw_osd ãŒç´„ 186 msï¼ˆåˆæœŸåŒ–/ãƒ•ã‚©ãƒ³ãƒˆç­‰ã®å½±éŸ¿ï¼‰ã€‚ä»¥å¾Œã¯ 0.2ã€œ1.8 ms ç¨‹åº¦ã§å®‰å®š
  - ç·åˆ: å¤šãã®ãƒ•ãƒ¬ãƒ¼ãƒ ãŒ 64ã€œ70 msï¼ˆç´„ 14ã€œ16 FPSï¼‰ã€‚OpenCV ç‰ˆã‚ˆã‚Šã‚„ã‚„è‰¯å¥½
  - æ³¨æ„: arcade.draw_text ã« PerformanceWarningï¼ˆText ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåˆ©ç”¨æ¨å¥¨ï¼‰

- ã¾ã¨ã‚ï¼ˆç¾æ™‚ç‚¹ã®æ‰€è¦‹ï¼‰
  1) å§¿å‹¢æ¨å®šãŒæœ€å¤§ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ï¼ˆç´„ 57ã€œ62 ms/ãƒ•ãƒ¬ãƒ¼ãƒ ï¼‰ã€‚duplicateï¼ˆ2äººï¼‰æ™‚ã‚‚æ”¯é…çš„
  2) OpenCV ç‰ˆã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆæç”»ãŒã‚¹ãƒ‘ã‚¤ã‚¯è¦å› ï¼ˆ50 ms ç´šï¼‰ãŒã‚ã‚‹ãŸã‚ã€FPSé–¾å€¤é€£å‹•ã®æŠ‘åˆ¶ãŒæœ‰åŠ¹å€™è£œ
  3) æç”»ï¼ˆã‚«ãƒ¡ãƒ©èƒŒæ™¯/ã€‡/å²©/OSDï¼‰ã¯ Arcade ç‰ˆã®ã»ã†ãŒè‹¥å¹²æœ‰åˆ©
  4) å–ã‚Šè¾¼ã¿è§£åƒåº¦ã¯ 720p ã®ã»ã†ãŒå¹³å‡ãƒ•ãƒ¬ãƒ¼ãƒ æ™‚é–“ãŒçŸ­ãã€1080pã¯ camera_read ã®å¢—åˆ†ã§ä¸åˆ©


12.1 Arcade ãƒ†ã‚­ã‚¹ãƒˆæç”»æœ€é©åŒ– æ¯”è¼ƒï¼ˆ10s, skip-first=1ï¼‰
- å¯¾è±¡CSV: runs/baseline_arcade_10s.csvï¼ˆAï¼‰, runs/arcade_text_10s.csvï¼ˆBï¼‰
- è¨­å®š: Arcade, --profile, --max-seconds 10, åˆæœŸ1ãƒ•ãƒ¬ãƒ¼ãƒ ã‚¹ã‚­ãƒƒãƒ—
- æ¦‚è¦:
  - A frame: 66.84 ms (14.96 fps), median 66.52 ms
  - B frame: 69.06 ms (14.48 fps), median 68.56 ms
  - å·®åˆ†: +2.22 ms (-0.48 fps) â†’ B ãŒé…ã„ï¼ˆã“ã®10ç§’ã‚µãƒ³ãƒ—ãƒ«ï¼‰
- ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ¥å¹³å‡(ms)ã¨ frame æ¯”:
  - camera_read: A 1.04 (1.6%) â†’ B 0.97 (1.4%)  Î” -0.07
  - pose_infer: A 58.16 (87.0%) â†’ B 56.44 (81.7%)  Î” -1.72
  - draw_camera: A 3.44 (5.1%) â†’ B 3.33 (4.8%)  Î” -0.11
  - draw_pose: A 0.23 (0.3%) â†’ B 0.35 (0.5%)  Î” +0.11
  - draw_rocks: A 0.00 (0.0%) â†’ B 0.10 (0.1%)  Î” +0.10
  - collide: A 0.00 â†’ B 0.00  Î” +0.00
  - draw_fx: A 0.00 (0.0%) â†’ B 0.37 (0.5%)  Î” +0.37
  - sfx: A 0.00 â†’ B 0.00  Î” +0.00
  - draw_osd: A 0.70 (1.0%) â†’ B 0.61 (0.9%)  Î” -0.08
- æ‰€è¦‹:
  - Text ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–ã«ã‚ˆã‚Š draw_osd ã¯åƒ…ã‹ã«æ”¹å–„ï¼ˆ-0.08 msï¼‰ã€‚pose_infer ã‚‚ -1.72 ms ã¨ä»Šå›ã‚µãƒ³ãƒ—ãƒ«ã§ã¯ã‚„ã‚„è‰¯åŒ–ã€‚
  - ãŸã ã— B ã¯ draw_pose/draw_rocks/draw_fx ãŒåˆè¨ˆ +0.58 msã€‚ã•ã‚‰ã«è¨ˆæ¸¬å¤–ã€Œotherã€ï¼ˆupdateç³»/ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ç­‰ï¼‰ãŒå¢—ãˆã€çµæœçš„ã« +2.22 ms ã®æ‚ªåŒ–ã€‚
  - ãƒ©ãƒ³å†…ã®ã‚²ãƒ¼ãƒ çŠ¶æ…‹ï¼ˆå²©æ•°ã‚„ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç™ºç”Ÿï¼‰ã®å·®ãƒ»æœªè¨ˆæ¸¬åŒºé–“ã®å¢—åŠ ãŒæ”¯é…çš„ã§ã€ãƒ†ã‚­ã‚¹ãƒˆæœ€é©åŒ–å˜ä½“ã®åŠ¹æœã¯åŸ‹ã‚‚ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ã€‚
- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:
  1) è¨ˆæ¸¬ç‚¹ã®è¿½åŠ : update_rocks / update_fx / update_game ã‚’è¨ˆæ¸¬ã—ã€Œotherã€ã‚’åˆ†é›¢ã€‚
  2) å›ºå®šæ¡ä»¶ãƒ™ãƒ³ãƒ: bench_render_staticï¼ˆå›ºå®šãƒ•ãƒ¬ãƒ¼ãƒ ãƒ»å›ºå®šå²©ï¼‰ã§ãƒ†ã‚­ã‚¹ãƒˆæç”»å·®åˆ†ã‚’å˜ç‹¬è©•ä¾¡ã€‚
  3) å†è¨ˆæ¸¬: åŒæ¡ä»¶ï¼ˆcapture/infer/duplicateå›ºå®šã€seedãŒã‚ã‚Œã°å›ºå®šï¼‰ã§10ã€œ30sè¨ˆæ¸¬ãƒ»ãƒªãƒ”ãƒ¼ãƒˆã—çµ±è¨ˆåŒ–ã€‚
  4) ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–: æœ¬æ¯”è¼ƒçµæœã‚’ã‚°ãƒ©ãƒ•åŒ–ã—ã¦è¨˜éŒ²ã€‚

13. æ¬¡å›å†é–‹æ™‚ã®é€²ã‚æ–¹ï¼ˆå®Ÿé¨“ãƒ—ãƒ©ãƒ³ï¼‰
- æ—©æœŸã« --duplicate ã®è¨ˆæ¸¬ã‚’è¿½åŠ ï¼ˆ2 äººå¯¾æˆ¦è² è·ã®æƒ³å®šï¼‰[å®Ÿæ–½æ¸ˆã¿]
  - ä¾‹ï¼ˆOpenCV ç‰ˆï¼‰:
    - uv run python -m game.main --profile --profile-csv runs/opencv_dup_10s.csv --max-seconds 10 --duplicate
  - ä¾‹ï¼ˆArcade ç‰ˆï¼‰:
    - uv run python -m game.main --arcade --profile --profile-csv runs/arcade_dup_10s.csv --max-seconds 10 --duplicate
  - ç›®çš„: 2 äººæ™‚ã®æç”»ãƒ»å½“ãŸã‚Šåˆ¤å®šãƒ»ã‚¨ãƒ•ã‚§ã‚¯ãƒˆå¢—åŠ ã®å½±éŸ¿ã‚’æ—©æœŸã«æŠŠæ¡

- Phase 1ï¼ˆæ¨è«–æœ€é©åŒ–ï¼‰ã‚’ã™ãæ¸¬ã‚Œã‚‹ä»•æ›ã‘ã®è¿½åŠ ï¼ˆé »åº¦é–“å¼•ãã¯æ¡ç”¨ã—ãªã„æ–¹é‡ï¼‰
  - CLI ã‚’è¿½åŠ 
    - --infer-size {128,160,192,224,256}ï¼ˆæ¨è«–å…¥åŠ›ã®ç¸®å°ï¼‰
    - æ¨è«–ã¯æ¯ãƒ•ãƒ¬ãƒ¼ãƒ å®Ÿè¡Œï¼ˆã‚²ãƒ¼ãƒ æ€§ã‚’é‡è¦–ã—ã€é–“å¼•ãã¯ã—ãªã„ï¼‰
  - ã‚¹ã‚¤ãƒ¼ãƒ—ã®å®Ÿè¡Œã¨ CSV åé›†
    - å›ºå®šæ¡ä»¶: capture=720p, --duplicate ã®æœ‰ç„¡ãã‚Œãã‚Œã§æ¯”è¼ƒ
    - æœŸå¾…: pose_infer ã‚’ 30ã€œ40 ms å°ä»¥ä¸‹ã«æŠ‘ãˆã€å…¨ä½“ 30 FPS ä»˜è¿‘ã‚’ç‹™ã†

- capture è§£åƒåº¦ã‚’ CLI åŒ– [å®Ÿè£…æ¸ˆã¿]
  - --capture-width/--capture-height ã§ 720p/1080p ã®æ¯”è¼ƒãŒå®¹æ˜“ã«
  - æç”»è§£åƒåº¦ã¯å¤‰ãˆãªã„ï¼ˆè¦ä»¶ã©ãŠã‚Šï¼‰ã€‚å–ã‚Šè¾¼ã¿ã¯ FHD/720p ã‚’ä½¿ã„åˆ†ã‘ã‚‹ï¼ˆç¾çŠ¶ã§ã¯720pã®æ–¹ãŒæœ‰åˆ©ï¼‰

- ã‚¨ãƒ•ã‚§ã‚¯ãƒˆæç”»ã®ã‚¹ãƒ‘ã‚¤ã‚¯å¯¾ç­–ï¼ˆOpenCV ç‰ˆï¼‰
  - æ—¢å­˜ã® fps_threshold_for_glow=10.0 ã‚’ 18ã€œ20 ã¸ä¸€æ™‚çš„ã«å¼•ãä¸Šã’ã¦æ¤œè¨¼ï¼ˆ12ã€œ16 FPS å¸¯ã§ã¯ glow ã‚’æŠ‘æ­¢ï¼‰
  - sigma/halo/core_weight ç­‰ã®ãƒ‘ãƒ©ãƒ¡ã‚¿ã‚’è»½é‡å´ã«ã‚·ãƒ•ãƒˆ
  - ç²’å­æ•°(count)ã®ä¸Šé™/å¯¿å‘½/layer åˆæˆã®ã‚³ã‚¹ãƒˆã‚’ FPS ã«å¿œã˜ã¦æ®µéšåˆ¶å¾¡

- Arcade æç”»ã®æ”¹å–„
  - Text ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ã®ç½®æ›ï¼ˆdraw_text ã‹ã‚‰ã®ç§»è¡Œï¼‰
  - å°†æ¥çš„ã«ã¯ SpriteList/Geometry ã§ã®ãƒãƒƒãƒåŒ–ã‚’æ¤œè¨

- åˆ†é›¢ãƒ™ãƒ³ãƒã®å®Ÿè£…ï¼ˆçŸ­æœŸã§ï¼‰
  - scripts/bench_capture_infer.pyï¼ˆå–ã‚Šè¾¼ã¿ï¼‹æ¨è«–ã®ã¿ï¼‰
  - scripts/bench_render_static.pyï¼ˆå›ºå®šãƒ•ãƒ¬ãƒ¼ãƒ ã§æç”»ã®ã¿ã€OpenCV/Arcadeï¼‰


12.2 æ¨è«–å…¥åŠ›ã‚µã‚¤ã‚ºã‚¹ã‚¤ãƒ¼ãƒ—ï¼ˆArcade, duplicate, 10s, skip-first=1ï¼‰
- æ¡ä»¶: --arcade, --duplicate, --max-seconds 10, --profile, --infer-size {160,192,224}
- ã‚³ãƒãƒ³ãƒ‰ä¾‹:
  - uv run python -m game.main --arcade --profile --profile-csv runs/arcade_dup_size160_10s.csv --max-seconds 10 --infer-size 160 --duplicate
  - uv run python -m game.main --arcade --profile --profile-csv runs/arcade_dup_size192_10s.csv --max-seconds 10 --infer-size 192 --duplicate
  - uv run python -m game.main --arcade --profile --profile-csv runs/arcade_dup_size224_10s.csv --max-seconds 10 --infer-size 224 --duplicate
- æ¯”è¼ƒï¼ˆscripts/compare_profiles.py ã‚’ä½¿ç”¨ã€--skip-first 1ï¼‰
  - 160 vs 192: frame_ms 72.92 â†’ 73.25 (+0.32), pose_infer 56.88 â†’ 56.77 (-0.12) ã»ã¼åŒç­‰ï¼ˆ192ãŒåƒ…ã‹ã«è‰¯ã„ã‚µãƒ³ãƒ—ãƒ«ï¼‰ã€‚
  - 192 vs 224: frame_ms 73.25 â†’ 77.63 (+4.38), pose_infer 56.77 â†’ 60.90 (+4.13) æ˜ç¢ºã«224ãŒæ‚ªåŒ–ã€‚
- æ‰€è¦‹:
  - duplicateï¼ˆ2äººï¼‰æ¡ä»¶ã§ã¯ 160/192 ãŒæœ‰åŠ›ã€224 ã¯æ‚ªåŒ–ã€‚
  - pose_infer æ”¯é…ã¯å¤‰ã‚ã‚‰ãšã€‚å…¥åŠ›ã‚’ä¸Šã’ã‚‹ã»ã©ç›´ç·šçš„ã«æ‚ªåŒ–ã€‚
  - 160 ã¨ 192 ã¯å†è¨ˆæ¸¬ã§é€†è»¢ã‚‚ã‚ã‚Šå¾—ã‚‹ãŸã‚ã€æ¤œå‡ºå“è³ªï¼ˆè¦‹ãŸç›®ï¼‰ã¨åˆã‚ã›ã¦é¸å®šã€‚

14. æ¨å¥¨å®Ÿè¡Œãƒ¬ã‚·ãƒ”ï¼ˆæ¬¡å›è¨ˆæ¸¬ç”¨ã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼‰
- ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ + duplicate
  - OpenCV:  uv run python -m game.main --profile --profile-csv runs/opencv_dup_10s.csv --max-seconds 10 --duplicate
  - Arcade:  uv run python -m game.main --arcade --profile --profile-csv runs/arcade_dup_10s.csv --max-seconds 10 --duplicate
- æ¨è«–ã‚µã‚¤ã‚ºã‚¹ã‚¤ãƒ¼ãƒ—ï¼ˆä¾‹ï¼‰
  - OpenCV:  uv run python -m game.main --profile --profile-csv runs/opencv_size160.csv --max-seconds 10 --infer-size 160
  - Arcade:  uv run python -m game.main --arcade --profile --profile-csv runs/arcade_size160.csv --max-seconds 10 --infer-size 160
- æ¨è«–é–“å¼•ãï¼ˆä¾‹ï¼‰
  - OpenCV:  uv run python -m game.main --profile --profile-csv runs/opencv_skip2.csv --max-seconds 10 --infer-skip-n 2
  - Arcade:  uv run python -m game.main --arcade --profile --profile-csv runs/arcade_skip2.csv --max-seconds 10 --infer-skip-n 2


12.3 OpenCL æ¯”è¼ƒï¼ˆArcade, duplicate, 10s, infer-size=192, skip-first=1ï¼‰
- æ¡ä»¶: --arcade --duplicate --max-seconds 10 --profile --infer-size 192
- æ¯”è¼ƒ: --opencl off vs on
  - off â†’ on: frame_ms 70.94 â†’ 68.76 (-2.18 ms, +0.45 fps)
  - pose_infer 54.23 â†’ 52.36 (-1.87 ms)
  - draw_pose/draw_fx ã«ã‚‚æ”¹å–„å‚¾å‘ï¼ˆã°ã‚‰ã¤ãè¦ç´ ã‚ã‚Šï¼‰ã€‚
- æ‰€è¦‹:
  - ã“ã®ç’°å¢ƒã§ã¯ OpenCL=on ãŒæœ‰åˆ©ã€‚å‰å‡¦ç†ï¼ˆcvtColor/resize ç­‰ï¼‰ã§åŠ¹ã„ã¦ã„ã‚‹å¯èƒ½æ€§ã€‚
  - æ¨å¥¨è¨­å®šãƒ—ãƒªã‚»ãƒƒãƒˆã« OpenCL=on ã‚’å«ã‚ã‚‹ã€‚

12.4 æ¨å¥¨è¨­å®šãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆç¾æ™‚ç‚¹ï¼‰
- Arcade + duplicate æƒ³å®šã®è»½é‡æ§‹æˆï¼ˆ30 FPS ã¸å‘ã‘ãŸæš«å®šï¼‰
  - --infer-size 160 ã¾ãŸã¯ 192ï¼ˆå“è³ªã¨é€Ÿåº¦ã®ãƒãƒ©ãƒ³ã‚¹ã§é¸å®šï¼‰
  - --opencl onï¼ˆä»Šå›ã®ç’°å¢ƒã§ã¯æœ‰åˆ©ï¼‰
  - --capture-width/height ã¯ 1280x720 æ¨å¥¨
  - --tasks-model models/pose_landmarker_lite.taskï¼ˆdelegate ã¯ CPU å‰æã€ç¾ç’°å¢ƒã§ã¯ GPU/NNAPI ã¯ä¸åˆ©ï¼‰

12.5 10ç§’æ¯”è¼ƒ: OpenCV vs Arcadeï¼ˆinfer-size=192, skip-first=1ï¼‰
- ã‚³ãƒãƒ³ãƒ‰:
  - OpenCV:  uv run python -m game.main --profile --profile-csv runs/opencv_10s.csv --max-seconds 10 --infer-size 192
  - Arcade:  uv run python -m game.main --arcade --profile --profile-csv runs/arcade_10s.csv --max-seconds 10 --infer-size 192
  - æ¯”è¼ƒ:    uv run python scripts/compare_profiles.py runs/opencv_10s.csv runs/arcade_10s.csv --skip-first 1 --out md
- ãƒ•ãƒ¬ãƒ¼ãƒ æ•°: OpenCV 51, Arcade 129
- Overall:
  - OpenCV: frame_ms 103.16 msï¼ˆ9.69 fpsï¼‰
  - Arcade: frame_ms 76.22 msï¼ˆ13.12 fpsï¼‰
  - Î”: -26.94 msï¼ˆ+3.43 fpsï¼‰â†’ Arcade ãŒæœ‰åˆ©
- ã‚»ã‚¯ã‚·ãƒ§ãƒ³å¹³å‡ï¼ˆms, frameæ¯”ï¼‰:
  - camera_read: 1.38 (1.3%) â†’ 0.97 (1.3%)  Î” -0.42
  - pose_infer: 69.94 (67.8%) â†’ 61.41 (80.6%)  Î” -8.53
  - draw_camera: 0.76 (0.7%) â†’ 3.62 (4.7%)  Î” +2.86
  - draw_pose: 0.69 (0.7%) â†’ 0.36 (0.5%)  Î” -0.33
  - draw_rocks: 0.02 (0.0%) â†’ 0.33 (0.4%)  Î” +0.31
  - draw_fx: 3.68 (3.6%) â†’ 0.67 (0.9%)  Î” -3.01
  - draw_osd: 0.23 (0.2%) â†’ 1.12 (1.5%)  Î” +0.89
- æ‰€è¦‹:
  1) Arcade ãŒç´„ 27 ms/ãƒ•ãƒ¬ãƒ¼ãƒ é«˜é€Ÿï¼ˆ~+3.4 fpsï¼‰
  2) pose_infer ãŒä¾ç„¶æ”¯é…çš„ï¼ˆArcade ã§ã‚‚ ~61 msï¼‰
  3) HUD ã‚’ Text ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–å¾Œã® draw_osd ã¯ ~1.1 ms ã¨è¨±å®¹ç¯„å›²
  4) draw_fx ã¯ Arcade ãŒè»½ã„ä¸€æ–¹ã€OpenCV ã¯é‡ã„å‚¾å‘
  5) draw_camera ã¯ Arcade ã§å¢—åŠ ï¼ˆpyglet blitï¼‰
- æ¬¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆP3-1 é–¢é€£ï¼‰:
  - Arcade: Rocks ã‚’ SpriteList/Geometry ã§ãƒãƒƒãƒåŒ–ã€ã€‡ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã® Geometry/instancing æ¤œè¨¼
  - Render-only ãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚«ãƒ¡ãƒ©/æ¨è«–ã‚’å‡çµï¼‰ã§ draw_* ã®ç´”ç²‹ã‚³ã‚¹ãƒˆã‚’éš”é›¢
  - duplicate æ¡ä»¶/20ã€œ30s ã§å†è¨ˆæ¸¬ã—ã€draw_* åˆè¨ˆã¨ frame_ms ã‚’æ¯”è¼ƒ

12.6 20ç§’æ¯”è¼ƒ: --arcade/--pipeline çµ„åˆã›ï¼ˆ2025-09-28, skip-first=1ï¼‰
- æ¡ä»¶: --max-seconds 20, --profile, æ¯”è¼ƒæ™‚ --skip-first 1ã€‚capture: 1280x720ã€model: models/pose_landmarker_lite.taskã€players: é€šå¸¸ï¼ˆ--duplicate ãªã—ï¼‰
- å‡ºåŠ›CSV:
  - runs/opencv_no_pipeline_20s.csv
  - runs/opencv_pipeline_20s.csv
  - runs/arcade_no_pipeline_20s.csv
  - runs/arcade_pipeline_20s.csv
- ã‚µãƒãƒªï¼ˆå¹³å‡ frame_ms â†’ FPS, framesï¼‰:
  - OpenCV / no pipeline: 103.14 ms â†’ 9.70 fps, frames=150
  - OpenCV / pipeline:    70.49 ms â†’ 14.19 fps, frames=219
  - Arcade / no pipeline: 77.67 ms â†’ 12.88 fps, frames=253
  - Arcade / pipeline:    25.42 ms â†’ 39.33 fps, frames=764
- ãƒšã‚¢æ¯”è¼ƒï¼ˆscripts/compare_profiles.py --skip-first 1ï¼‰:
  - OpenCV: pipeline ã‚ã‚Š vs ãªã— â†’ Î” -32.65 msï¼ˆ+4.49 fpsï¼‰â†’ faster
    - pose_infer: 62.80 â†’ 0.01 msï¼ˆæ¨è«–ã‚’åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰åŒ–ã—ã€ãƒ¡ã‚¤ãƒ³å´ã‹ã‚‰ã»ã¼æ¶ˆãˆã‚‹ï¼‰
    - draw_fx:    20.11 â†’ 44.19 msï¼ˆç›¸å¯¾æ¯”ç‡ãŒå¢—åŠ ã€‚OpenCV å´ã§ã¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆæç”»ãŒæ”¯é…çš„ã«ãªã‚Šã‚„ã™ã„ï¼‰
  - Arcade: pipeline ã‚ã‚Š vs ãªã— â†’ Î” -52.24 msï¼ˆ+26.46 fpsï¼‰â†’ faster
    - pose_infer: 58.18 â†’ 0.01 ms
    - draw_osd:    8.38 â†’ 11.54 msï¼ˆArcade ã®ãƒ†ã‚­ã‚¹ãƒˆæç”»ãŒç›¸å¯¾çš„ã«ç›®ç«‹ã¤ï¼‰
  - Backendï¼ˆno pipelineï¼‰OpenCV â†’ Arcade â†’ Î” -25.47 msï¼ˆ+3.18 fpsï¼‰â†’ Arcade faster
    - draw_fx:    20.11 â†’ 1.21 msï¼ˆArcade ã® GPU æç”»ãŒæœ‰åˆ©ï¼‰
    - draw_camera: 0.74 â†’ 3.69 ms, draw_osd: 0.24 â†’ 8.38 ms
  - Backendï¼ˆpipelineï¼‰OpenCV â†’ Arcade â†’ Î” -45.07 msï¼ˆ+25.15 fpsï¼‰â†’ Arcade faster
    - draw_fx:    44.19 â†’ 1.06 msï¼ˆArcade ãŒåœ§å€’çš„ã«è»½ã„ï¼‰
    - draw_camera: 0.97 â†’ 4.93 ms, draw_osd: 0.29 â†’ 11.54 ms
- æ‰€è¦‹/çµè«–:
  1) æœ€é€Ÿã¯ Arcade + pipelineï¼ˆç´„ 39.3 FPSï¼‰ã€‚
  2) pipeline åŒ–ã®åŠ¹æœãŒéå¸¸ã«å¤§ãã„ï¼ˆpose_infer ã‚’ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ã‹ã‚‰æ’é™¤ï¼‰ã€‚
  3) OpenCV ã¯ draw_fx ãŒãƒœãƒˆãƒ«ãƒãƒƒã‚¯åŒ–ã—ã‚„ã™ã„ã€‚Arcade ã¯ draw_osd ãŒç›¸å¯¾çš„ã«é‡ã„ã€‚
  4) æ¬¡ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ Arcade å´ HUD ãƒ†ã‚­ã‚¹ãƒˆæœ€é©åŒ–ï¼ˆText å†åˆ©ç”¨/æç”»å›æ•°å‰Šæ¸›ï¼‰ã¨ã€OpenCV å´ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®è»½é‡åŒ–ã‚’å„ªå…ˆã€‚

15. ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ï¼ˆä»»æ„ï¼‰
- Jira: Phase 0 å®Œäº†ã€Phase 1/2/3 ã®ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆï¼ˆæ¨è«–ã‚µã‚¤ã‚º/é »åº¦ã€capture CLIã€ã‚¨ãƒ•ã‚§ã‚¯ãƒˆè»½é‡åŒ–ã€Arcade Text åŒ–ã€åˆ†é›¢ãƒ™ãƒ³ãƒï¼‰
- Confluence: ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³çµæœãƒ»CSVãƒ»æ‰€è¦‹ã‚’è¨˜éŒ²ï¼ˆã“ã® plan.md ã®è¦ç´„ï¼‹ã‚°ãƒ©ãƒ•ï¼‰
- PR: è¨ˆæ¸¬æ©Ÿèƒ½ã®è¿½åŠ ã‚’ main ã‹ã‚‰åˆ†å²ã—ãŸãƒ–ãƒ©ãƒ³ãƒã§ PR åŒ–
